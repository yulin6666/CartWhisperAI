# CartWhisper AI 公测与发布计划

## 一、公测前必须完成的事项

### 1. 生产环境配置 (Critical)

| 任务 | 当前状态 | 说明 |
|------|----------|------|
| 更新 `application_url` | example.com | 需要替换为生产域名 |
| 更新 `auth.redirect_urls` | example.com | OAuth 回调地址 |
| 更新 `app_proxy.url` | example.com | App Proxy 地址 |
| 数据库迁移 | SQLite | 生产环境需要 PostgreSQL |
| 环境变量配置 | .env 文件 | 迁移到 Shopify Partner Dashboard |

**shopify.app.toml 需要更新的配置：**
```toml
application_url = "https://你的生产域名.com"
[auth]
redirect_urls = ["https://你的生产域名.com/api/auth"]
[app_proxy]
url = "https://你的生产域名.com/api/proxy"
```

### 2. 数据库准备

- [ ] 在 Railway/Supabase/PlanetScale 创建 PostgreSQL 数据库
- [ ] 更新 `prisma/schema.prisma` 的 datasource
- [ ] 运行数据库迁移：`npx prisma migrate deploy`
- [ ] 设置数据库备份策略

### 3. 部署基础设施

- [ ] 部署应用到 Railway/Fly.io/Render
- [ ] 配置 HTTPS (必须)
- [ ] 设置自定义域名
- [ ] 配置环境变量
- [ ] 测试部署后的应用访问

---

## 二、公测风险评估

### 高风险项

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| **后端服务故障** | 推荐功能完全不可用 | 添加健康检查、错误提示、备用方案 |
| **DeepSeek API 限流/故障** | AI 生成失败 | 添加重试机制、缓存已生成内容 |
| **数据安全** | 商品数据泄露 | 加密传输、审核后端安全性 |
| **性能问题** | 大商店同步超时 | 分批处理、后台任务、进度提示 |

### 中等风险项

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| **主题兼容性** | 弹窗样式异常 | 测试多种主题、提供样式配置选项 |
| **浏览器兼容性** | 功能异常 | 测试主流浏览器 |
| **权限问题** | 功能受限 | 明确说明所需权限及原因 |
| **Rate Limit 误判** | 用户体验差 | 添加清晰的限制提示、解锁说明 |

### 低风险项

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| **UI/UX 问题** | 用户困惑 | 收集反馈、快速迭代 |
| **文档不完善** | 使用门槛高 | 准备操作指南、视频教程 |

---

## 三、公测流程建议

### 阶段 1：内部测试 (1-2 周)

**目标：** 验证核心流程无重大 Bug

- [ ] 在自己的开发商店完整走一遍流程
- [ ] 测试不同商品数量 (10/100/500/1000)
- [ ] 测试主题扩展在不同主题下的表现
- [ ] 验证 webhook 正常工作
- [ ] 测试错误场景 (网络中断、API 超时等)

### 阶段 2：小规模公测 (2-4 周)

**目标：** 收集真实商店反馈

**招募方式：**
- Shopify 社区/论坛发帖
- 社交媒体 (Twitter, Reddit r/shopify)
- 独立站站长群/微信群
- 朋友/同事的商店

**公测商店数量建议：** 5-10 家

**公测商店选择标准：**
- [ ] 不同规模 (小型 10-50 商品 / 中型 50-200 / 大型 200+)
- [ ] 不同行业 (服装、电子、食品、家居等)
- [ ] 不同主题
- [ ] 愿意提供反馈

**公测期间需要做的：**
- [ ] 建立反馈渠道 (微信群/Discord/邮件)
- [ ] 每周收集一次反馈
- [ ] 记录所有 Bug 和功能建议
- [ ] 监控服务器性能和错误日志
- [ ] 快速响应紧急问题

### 阶段 3：公测结束评估

**成功标准：**
- [ ] 核心流程成功率 > 95%
- [ ] 无数据丢失/安全问题
- [ ] 用户满意度 > 7/10
- [ ] 无阻塞性 Bug

---

## 四、公测商店激励方案

| 激励类型 | 说明 |
|----------|------|
| **免费使用** | 公测期间免费使用所有功能 |
| **终身折扣** | 正式上线后提供 50% 永久折扣 |
| **功能投票权** | 公测用户参与新功能优先级投票 |
| **早期采用者标签** | 商店展示 "Early Adopter" 徽章 |

---

## 五、App Store 提交前准备

### 必须材料

| 材料 | 状态 | 说明 |
|------|------|------|
| 隐私政策 | 待创建 | 必须说明收集的数据及用途 |
| 服务条款 | 待创建 | 明确责任和使用规范 |
| 应用描述 | 待创建 | App Store 展示用 |
| 应用截图 | 待创建 | 至少 3-5 张高质量截图 |
| 应用图标 | 待确认 | 符合 Shopify 规范 |
| 支持联系方式 | 待配置 | 邮箱/网站 |
| 定价计划 | 已设计 | 在 Partner Dashboard 配置 |

### 隐私政策必须包含

1. **收集的数据类型**
   - 商品信息 (标题、描述、图片、价格)
   - 订单数据 (如果使用 read_orders)
   - 客户数据 (如果使用 read_customers)

2. **数据使用目的**
   - 生成 AI 推荐
   - 分析商品相似度
   - 性能统计

3. **第三方服务披露**
   - DeepSeek AI (文案生成)
   - Railway 后端 (数据处理)

4. **数据存储和安全**
   - 数据存储位置
   - 加密方式
   - 数据保留期限

5. **用户权利**
   - 删除数据请求
   - 数据导出
   - 联系方式

### 权限说明 (Scopes 申请理由)

| 权限 | 使用理由 |
|------|----------|
| `read_products` | 读取商品信息用于生成推荐 |
| `write_products` | 创建演示商品 (可考虑移除) |
| `read_orders` | 分析购买模式 (如未使用可移除) |
| `read_customers` | 用户行为分析 (如未使用可移除) |

**建议：** 审查代码确认实际使用的权限，移除不必要的 scopes，减少审核风险。

---

## 六、技术检查清单

### 安全检查

- [ ] 所有 API 密钥从代码中移除，使用环境变量
- [ ] Webhook 签名验证已启用
- [ ] HMAC 验证 App Proxy 请求
- [ ] 无 XSS/SQL 注入风险
- [ ] HTTPS 强制启用
- [ ] 错误信息不泄露敏感信息

### 性能检查

- [ ] GraphQL 查询有分页
- [ ] 大量数据处理有进度提示
- [ ] 图片加载有懒加载
- [ ] API 调用有超时处理

### 兼容性检查

- [ ] 主题扩展在 Dawn 主题测试通过
- [ ] 主题扩展在 2-3 个付费主题测试通过
- [ ] Chrome/Safari/Firefox 测试通过
- [ ] 移动端 Admin 测试通过
- [ ] 店铺前台移动端测试通过

---

## 七、监控和运维准备

### 日志和监控

- [ ] 设置错误日志收集 (Sentry/LogRocket)
- [ ] 设置性能监控
- [ ] 设置 Uptime 监控
- [ ] 配置告警通知

### 支持准备

- [ ] 准备常见问题 FAQ
- [ ] 创建使用文档/视频
- [ ] 设置支持邮箱
- [ ] 准备问题升级流程

---

## 八、公测反馈收集模板

### 安装反馈
1. 安装过程是否顺利？
2. 权限说明是否清晰？
3. 初始设置花费多少时间？

### 功能反馈
1. 商品同步是否成功？
2. 推荐结果是否准确/有用？
3. 弹窗展示效果如何？
4. 有哪些功能建议？

### 性能反馈
1. 同步速度如何？
2. 页面加载是否流畅？
3. 有没有遇到超时/错误？

### 整体评价
1. 整体满意度 (1-10)
2. 是否愿意付费使用？
3. 期望的定价？
4. 还希望看到什么功能？

---

## 九、时间线建议

| 阶段 | 任务 |
|------|------|
| **准备期** | 完成生产环境配置、数据库迁移、部署 |
| **内测期** | 自测完成、Bug 修复、准备文档 |
| **公测期** | 招募商店、收集反馈、迭代修复 |
| **提交准备期** | 准备材料、最终测试 |
| **提交后** | 响应 Shopify 审核反馈 |

---

## 十、联系和支持

- 技术支持邮箱: [待配置]
- 公测反馈群: [待创建]
- 文档网站: [待创建]

---

**最后更新：** 2026-01-12
